<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Math Cross">
<link rel="manifest" href="data:application/json,{%22name%22:%22Math%20CrosswordZ%22,%22short_name%22:%22MathCross%22,%22start_url%22:%22./%22,%22display%22:%22standalone%22,%22background_color%22:%22%23e3f2fd%22,%22theme_color%22:%22%231976d2%22,%22icons%22:[{%22src%22:%22data:image/svg+xml,%253Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20192%20192'%253E%253Crect%20fill='%2523e3f2fd'%20width='192'%20height='192'%20rx='20'/%253E%253Ctext%20x='96'%20y='120'%20text-anchor='middle'%20fill='%25231976d2'%20font-size='80'%20font-weight='bold'%253E+%253C/text%253E%253C/svg%253E%22,%22sizes%22:%22192x192%22,%22type%22:%22image/svg+xml%22},{%22src%22:%22data:image/svg+xml,%253Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%253E%253Crect%20fill='%2523e3f2fd'%20width='512'%20height='512'%20rx='50'/%253E%253Ctext%20x='256'%20y='320'%20text-anchor='middle'%20fill='%25231976d2'%20font-size='200'%20font-weight='bold'%253E+%253C/text%253E%253C/svg%253E%22,%22sizes%22:%22512x512%22,%22type%22:%22image/svg+xml%22}]}">
<link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect fill='%23e3f2fd' width='180' height='180' rx='20'/%3E%3Ctext x='90' y='110' text-anchor='middle' fill='%231976d2' font-size='70' font-weight='bold'%3E+%3C/text%3E%3C/svg%3E">
<title>Math Crossword</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none;-webkit-user-select:none;-webkit-touch-callout:none}
body{font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;background:linear-gradient(135deg,#e3f2fd,#f3e5f5);min-height:100vh;touch-action:manipulation;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);overflow-x:hidden}
.header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:rgba(255,255,255,0.9);backdrop-filter:blur(10px);box-shadow:0 2px 15px rgba(0,0,0,0.1);position:sticky;top:0;z-index:100}
.header h1{font-size:24px;color:#1976d2;font-weight:600}
.score{background:linear-gradient(45deg,#ffc107,#ff9800);color:white;padding:8px 15px;border-radius:20px;font-weight:bold;box-shadow:0 2px 10px rgba(255,193,7,0.3)}
.game-area{padding:20px;display:flex;flex-direction:column;align-items:center;gap:20px;min-height:calc(100vh - 80px - env(safe-area-inset-top) - env(safe-area-inset-bottom))}
.board{display:grid;gap:1px;background:rgba(255,255,255,0.8);padding:10px;border-radius:20px;box-shadow:0 8px 30px rgba(0,0,0,0.1);width:min(95vw,95vh,450px);height:min(95vw,95vh,450px);margin:0 auto;place-self:center}
.cell{aspect-ratio:1;background:#fff;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:clamp(8px,min(2.5vw,2.5vh),14px);font-weight:600;box-shadow:0 1px 4px rgba(0,0,0,0.1);transition:all 0.2s;touch-action:manipulation;min-width:0;overflow:hidden}
.cell.given{background:linear-gradient(45deg,#fff3e0,#ffcc02);color:#f57c00}
.cell.operator{background:linear-gradient(45deg,#e8f5e8,#4caf50);color:#2e7d32}
.cell.equals{background:linear-gradient(45deg,#e3f2fd,#2196f3);color:#1565c0}
.cell.empty-slot{background:linear-gradient(45deg,#f5f5f5,#e0e0e0);border:2px dashed #bdbdbd;cursor:pointer;touch-action:manipulation}
.cell.empty-slot:active{background:linear-gradient(45deg,#e8e8e8,#d0d0d0);transform:scale(0.95)}
.cell.placed-correct{background:linear-gradient(45deg,#c8e6c9,#4caf50);color:#1b5e20;border:2px solid #388e3c;cursor:pointer;touch-action:manipulation}
.cell.placed-correct:active{transform:scale(0.95)}
.cell.incorrect{background:linear-gradient(45deg,#ffebee,#f44336);color:white;animation:shake 0.5s;cursor:pointer;touch-action:manipulation}
.cell.incorrect:active{transform:scale(0.95)}
.numbers{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;padding:15px;background:rgba(255,255,255,0.8);border-radius:20px;box-shadow:0 8px 30px rgba(0,0,0,0.1);max-width:90vw}
.number-tile{width:50px;height:50px;background:linear-gradient(45deg,#e8f5e8,#81c784);color:#2e7d32;border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:bold;box-shadow:0 4px 15px rgba(129,199,132,0.3);cursor:pointer;transition:all 0.2s;touch-action:manipulation}
.number-tile:active{transform:scale(0.9)}
.number-tile.selected{background:linear-gradient(45deg,#ff5722,#d84315);color:white;transform:scale(1.05)}
.number-tile.selected:active{transform:scale(1.0)}
.btn{background:linear-gradient(45deg,#2196f3,#1976d2);color:white;border:none;padding:12px 24px;border-radius:25px;font-size:16px;font-weight:600;box-shadow:0 4px 15px rgba(33,150,243,0.3);cursor:pointer;transition:all 0.2s;touch-action:manipulation}
.btn:active{transform:translateY(2px);box-shadow:0 2px 8px rgba(33,150,243,0.3)}
.status{text-align:center;font-size:16px;color:#666;padding:10px;background:rgba(255,255,255,0.7);border-radius:15px;margin-bottom:20px}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
@media(max-width:480px){.header{padding:8px 15px}.header h1{font-size:18px}.score{padding:6px 12px;font-size:14px}.game-area{padding:10px;gap:15px}.board{padding:8px;gap:1px}.cell{font-size:clamp(6px,2vw,10px);border-radius:3px}.number-tile{width:40px;height:40px;font-size:14px}.btn{padding:10px 20px;font-size:14px}.status{font-size:14px;padding:8px}}
@media(orientation:landscape)and(max-height:600px){.game-area{gap:8px;padding:5px}.board{width:min(60vh,90vw);height:min(60vh,90vw)}.numbers{padding:8px}.status{margin-bottom:5px}}
@media(max-width:320px){.board{padding:5px}.cell{font-size:clamp(5px,1.8vw,8px)}.number-tile{width:35px;height:35px;font-size:12px}}
</style>
</head>
<body>
<div class="header">
<h1>Math Cross</h1>
<div class="score" id="level">Lvl 1</div>
</div>
<div class="game-area">
<div class="board" id="gameBoard"></div>
<div class="numbers" id="numbersHand"></div>
<button class="btn" id="newBtn">Neues Spiel</button>
<div class="status" id="status">Tippe auf Zahlen und dann auf leere Felder</div>
</div>
<script>
class MathCrossword{
constructor(){this.size=12;this.grid=Array(this.size).fill().map(()=>Array(this.size).fill(null));this.availableNumbers=[];this.expected=new Map();this.equations=[];this.selectedNum=-1;this.level=1;this.placedNumbers=new Set()}
newPuzzle(){this.grid=Array(this.size).fill().map(()=>Array(this.size).fill(null));this.expected.clear();this.equations=[];this.availableNumbers=[];this.selectedNum=-1;this.placedNumbers=new Set();this.generatePuzzle();this.hideNumbers();this.render();this.updateStatus('Tippe auf Zahlen und dann auf leere Felder')}
generatePuzzle(){this.addEquation(3,5,1);for(let i=0;i<12;i++)this.tryIntersect()}
addEquation(x,y,dir,intersectVal=null,intersectPos=-1){const ops=['+','-','*'];const op=ops[Math.floor(Math.random()*3)];let n1,n2,res;if(intersectPos===0)n1=intersectVal;else if(intersectPos===2)n2=intersectVal;else if(intersectPos===4)res=intersectVal;switch(op){case'+':if(intersectPos===4){n1=Math.floor(Math.random()*Math.min(res-1,99))+1;n2=res-n1}else{n1=n1||Math.floor(Math.random()*50)+1;n2=n2||Math.floor(Math.random()*Math.min(100-n1,99))+1;res=n1+n2}break;case'-':if(intersectPos===4){n2=Math.floor(Math.random()*Math.min(res-1,99))+1;n1=res+n2}else if(intersectPos===2){n1=n2+Math.floor(Math.random()*Math.min(100-n2,99))+1;res=n1-n2}else{res=Math.floor(Math.random()*99)+1;n2=Math.floor(Math.random()*res)+1;n1=res+n2;if(n1>100){n1=Math.floor(Math.random()*50)+51;n2=Math.floor(Math.random()*(n1-1))+1;res=n1-n2}}break;case'*':if(intersectPos===4){if(res>50)return false;const factors=[];for(let i=2;i<=Math.min(res,10);i++){if(res%i===0&&res/i<=50&&res/i>=1)factors.push(i)}if(!factors.length)return false;n1=factors[Math.floor(Math.random()*factors.length)];n2=res/n1}else{n1=n1||Math.floor(Math.random()*10)+2;n2=n2||Math.floor(Math.random()*Math.min(Math.floor(100/n1),50))+1;res=n1*n2}break}if(n1<1||n2<1||res<1||n1>100||n2>100||res>100)return false;const vals=[n1,op,n2,'=',res];if(!this.canPlaceEquation(x,y,dir,vals,intersectPos))return false;for(let i=0;i<5;i++){const px=dir?x+i:x;const py=dir?y:y+i;if(px<this.size&&py<this.size){this.grid[py][px]=vals[i];if(typeof vals[i]==='number')this.expected.set(`${px}-${py}`,vals[i])}}this.equations.push({x,y,dir,vals});return true}
canPlaceEquation(x,y,dir,vals,intersectPos){for(let i=0;i<5;i++){const px=dir?x+i:x;const py=dir?y:y+i;if(px<0||px>=this.size||py<0||py>=this.size)return false;const existing=this.grid[py][px];if(existing){if(i===intersectPos&&existing===vals[i])continue;return false}}return true}
tryIntersect(){for(let attempt=0;attempt<20;attempt++){const eq=this.equations[Math.floor(Math.random()*this.equations.length)];const newDir=eq.dir?0:1;const intersectPos=[0,2,4][Math.floor(Math.random()*3)];const intersectX=eq.dir?eq.x+intersectPos:eq.x;const intersectY=eq.dir?eq.y:eq.y+intersectPos;const intersectVal=eq.vals[intersectPos];const offset=Math.floor(Math.random()*3);const newX=newDir?intersectX-offset*2:intersectX;const newY=newDir?intersectY:intersectY-offset*2;if(this.addEquation(newX,newY,newDir,intersectVal,offset*2))return}}
hideNumbers(){const hiddenSlots=new Set();this.availableNumbers=[];this.equations.forEach(eq=>{const slots=[];for(let i=0;i<5;i+=2){const px=eq.dir?eq.x+i:eq.x;const py=eq.dir?eq.y:eq.y+i;const key=`${px}-${py}`;if(px<this.size&&py<this.size&&!hiddenSlots.has(key)&&i!==4){slots.push({x:px,y:py,value:this.grid[py][px],key})}}if(slots.length){const slot=slots[Math.floor(Math.random()*slots.length)];this.availableNumbers.push(slot.value);this.grid[slot.y][slot.x]='empty';hiddenSlots.add(slot.key)}});this.availableNumbers.sort((a,b)=>a-b)}
render(){const board=document.getElementById('gameBoard');board.style.gridTemplateColumns=`repeat(${this.size}, 1fr)`;board.innerHTML='';for(let y=0;y<this.size;y++){for(let x=0;x<this.size;x++){const div=document.createElement('div');const cell=this.grid[y][x];if(!cell){div.className='cell';div.style.visibility='hidden'}else if(cell==='empty'){div.className='cell empty-slot';div.onclick=()=>this.placeNumber(x,y);div.ontouchstart=e=>{e.preventDefault();this.placeNumber(x,y)}}else if(typeof cell==='number'){div.className=this.getCellClass(x,y,cell);div.textContent=cell;if(this.placedNumbers.has(`${x}-${y}`)){div.onclick=()=>this.remove(x,y);div.ontouchstart=e=>{e.preventDefault();this.remove(x,y)}}}else{div.className=`cell ${cell==='='?'equals':'operator'}`;div.textContent=cell}board.appendChild(div)}}this.renderHand();document.getElementById('level').textContent=`Lvl ${this.level}`}
getCellClass(x,y,cell){const expected=this.expected.get(`${x}-${y}`);const wasPlaced=this.placedNumbers.has(`${x}-${y}`);if(!expected||!wasPlaced)return'cell given';return cell===expected?'cell placed-correct':'cell incorrect'}
renderHand(){const hand=document.getElementById('numbersHand');hand.innerHTML='';this.availableNumbers.forEach((num,i)=>{const tile=document.createElement('div');tile.className=`number-tile${this.selectedNum===i?' selected':''}`;tile.textContent=num;tile.onclick=()=>this.selectNumber(i);tile.ontouchstart=e=>{e.preventDefault();this.selectNumber(i)};hand.appendChild(tile)})}
selectNumber(i){this.selectedNum=this.selectedNum===i?-1:i;this.renderHand()}
placeNumber(x,y){if(this.selectedNum<0)return;this.grid[y][x]=this.availableNumbers[this.selectedNum];this.placedNumbers.add(`${x}-${y}`);this.availableNumbers.splice(this.selectedNum,1);this.selectedNum=-1;this.render();this.checkWin()}
remove(x,y){const cell=this.grid[y][x];if(typeof cell==='number'&&this.placedNumbers.has(`${x}-${y}`)){this.availableNumbers.push(cell);this.availableNumbers.sort((a,b)=>a-b);this.grid[y][x]='empty';this.placedNumbers.delete(`${x}-${y}`);this.selectedNum=-1;this.render()}}
checkWin(){if(this.availableNumbers.length)return;const allCorrect=[...this.expected.entries()].every(([key,val])=>{const[x,y]=key.split('-').map(Number);return this.grid[y][x]===val});this.updateStatus(allCorrect?'🎉 Perfekt! Neues Level in 2 Sekunden...':'❌ Einige Zahlen sind falsch!');if(allCorrect)setTimeout(()=>{this.level++;this.newPuzzle()},2000)}
updateStatus(text){document.getElementById('status').textContent=text}
}
const game=new MathCrossword();
document.getElementById('newBtn').onclick=()=>game.newPuzzle();
document.getElementById('newBtn').ontouchstart=e=>{e.preventDefault();game.newPuzzle()};
document.addEventListener('DOMContentLoaded',()=>game.newPuzzle());
</script>
</body>
</html>
